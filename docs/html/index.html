<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>A singular Riemannian geometry approach to Deep Neural Networks.: Introduction</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">A singular Riemannian geometry approach to Deep Neural Networks.
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Introduction </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="What"></a>
What is this library?</h1>
<p>This library is a basic neural network written in C++ implementing the 1-dimensional SiMEC and SiMExp algorithms from the paper "A singular Riemannian geometry approach to Deep Neural Networks II. Reconstruction of 1-D equivalence classes".</p>
<p>In this version there are no training methods, since there already are other libraries - such as Tensorflow, Caffe, PyTorch or OpenNN - implementing efficient training methods. At the current development stage including some training methods would only have meant to reinvent the wheel, since the main aim of this version of the library is to test the SiMEC1D and SiMExp1D algorithms. However, this library is not dependent on a particular framework for the training, in the sense that only the weights and the biases from a trained network are needed, along with the structure of the neural network. For more information about the structure of this file, see <a class="el" href="wb_file.html">On the structure of the file containing the weights and the biases</a>. Given these information, the neural network is then built from scratch, for motivations related to SiMEC_1D and SiMExp_1D algorithms. We also avoid making use of automatic differentiation, which has the unfortunate side effect of slowing down the two algorithms considerably, preferring a hard-coding approach, which allows faster computations.</p>
<p>In our examples we employed Keras with Tensorflow as the backend (and we provide the code to extract the weights and the biases from the trained network) but one can feel free to use the framework is most confortable with.</p>
<p>We use the Eigen library to perform the matrix operations. Eigen is provided along with the neural network, as a headers-only library. We store the sparse matrix containing the derivatives of a layer map with respect to the weights and biases in a special reduced form of the Jacobian matrix. See <a class="el" href="reduced_form_matrix.html">On the reduced form of the Jacobian matrices</a> for the details. We employ the classes VectorXd and MatrixXd, storing the entries as doubles because the precision of the float type is not sufficient to run the SiMEC_1D and SiMExp_1D algorithms with sufficient accuracy.</p>
<h1><a class="anchor" id="Brief"></a>
Brief description of the repository</h1>
<p>In the repository, which you can find at <a href="http://github.com/alessiomarta/simec-1d-test-code">http://github.com/alessiomarta/simec-1d-test-code</a> there are:</p><ul>
<li>The library.</li>
<li>Some python scripts to train the neural network employed for the numerical experiments of the paper "A singular Riemannian geometry approach to Deep Neural Networks II. Reconstruction of 1-D equivalence classes" in the datasets folder. See <a class="el" href="num_exps.html">Brief description of the the datasets of the numerical experiments</a>.</li>
<li>Some python scripts to plot the data generated by the SiMEC and SiMExp algorithms using the aforementioned datasets, in the output folder. See <a class="el" href="num_exps.html">Brief description of the the datasets of the numerical experiments</a>.</li>
<li>The code (in C++) to run the algorithms. See <a class="el" href="test_main.html">How to use the example code</a>.</li>
</ul>
<h1><a class="anchor" id="How1"></a>
How to compile the test code</h1>
<p>To compile the test code we provide a makefile. Open the terminal in the folder in which you find "main.cpp" and type "make". Before to compile modifiy the Makefile to use the instruction set extensions supported by your CPU. The library does not require to install Eigen, which is provided as headers only along with the neural network. However, it requires a previous installation of OpenMP.</p>
<p>Note: In the provided makefile we compile using C++17. You can use previous C++ standards, but consider that Eigen up to version 3.4 is standard C++03 and versions following 3.4 will be C++14.</p>
<h1><a class="anchor" id="How2"></a>
How to use the library in Python</h1>
<p>We use pybind11 to generate Python wrappers for the library. The source file containing the wrappers for <a class="el" href="neural__network_8h_source.html">neural_network.h</a> is py_net.cpp</p>
<p><b> Eigen3 and pybind11 must be installed on the machine. </b></p>
<p>To build the Python wrapper (using a Linux-based OS) open a terminal and type:</p>
<p>g++ -O3 -march=native -Ofast -lpthread -DNDEBUG -D_GLIBCXX_PARALLEL -ffast-math -Wall -shared -std=c++17 -Ofast -fno-builtin -ffast-math -mmmx -msse -msse2 -msse3 -msse4 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -frename-registers -m64 -ftree-vectorize -funroll-loops -fopenmp -fopenmp-simd -fPIC $(python3 -m pybind11 &ndash;includes) layer.cpp fc_layer_sg.cpp fc_layer_sm.cpp fc_layer_sp.cpp fc_layer_sl.cpp neural_network.cpp activation_functions.cpp read_csv.cpp py_net.cpp -o py_net$(python3-config &ndash;extension-suffix)</p>
<ul>
<li>We compile using C++17. You can use previous C++ standards, but consider that Eigen up to version 3.4 is standard C++03 and versions following 3.4 will be C++14.</li>
<li>It may be necessary to add the paths of pybind11 and python if they are not in your compiler's default include paths.</li>
<li>Before to build the python wrapper, check the instruction set extensions supported by your CPU.</li>
</ul>
<p>To use the library in Python, import the module py_net.</p>
<h1><a class="anchor" id="FAQ"></a>
FAQ</h1>
<p><b>Why don't you employ the Tensor class from Eigen?</b></p>
<p>In the current implementation we do not use the tensor class form Eigen simply because it is not strictly needed. In addition, avoiding tensor at this stage simplifies the testing of SiMEC1D and SiMExp1D algorithms, and allows to follow the notation employed in the paper "A singular Riemannian geometry approach to Deep Neural Networks II. Reconstruction of 1-D equivalence classes.". </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
